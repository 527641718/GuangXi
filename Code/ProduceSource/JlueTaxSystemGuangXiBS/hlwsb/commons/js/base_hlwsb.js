//hlwsbTools
//function showAutoCalc(){var e=document.getElementById("calcButton"),t=document.getElementById("inputLi");e||window.frames[0].document&&(e=window.frames[0].document.getElementById("calcButton"),t=window.frames[0].document.getElementById("inputLi"));if(!e)return;e.style.display=="none"?(e.style.display="block",t.style.display="block"):(e.style.display="none",t.style.display="none")}var hlwsbTools=baseTools||{};hlwsbTools.cnf={clientURL:"",contextPath:""},hlwsbTools.getClientOrServerUrl=function(){return hlwsbTools.cnf.clientURL!=""?hlwsbTools.cnf.clientURL:hlwsbTools.cnf.contextPath},hlwsbTools.getUserIdSeq=function(){return this.getCookie("USER_SEQ")},hlwsbTools.getUserId=function(){var e="";try{switch(this.getUserType()){case 3:case 4:e=this.getCookie("QX_USER").data.USER_ZH;break;default:e=this.getCookie("QX_USER").data.USER_ID}}catch(t){}return e},hlwsbTools.getUserZh=function(){return this.getCookie("QX_USER").data.USER_ZH},hlwsbTools.getUserMc=function(){return this.getCookie("QX_USER").data.USER_MC},hlwsbTools.getYGZNSRLX_DM=function(){return this.getCookie("QX_USER").data.YGZNSRLX_DM},hlwsbTools.getYZLBZ=function(){return this.getCookie("QX_USER").data.YZLBZ},hlwsbTools.getSCJYDLXDH=function(){return this.getCookie("QX_USER").data.SCJYDLXDH},hlwsbTools.getSDHBZ=function(){return this.getCookie("QX_USER").data.SDHBZ},hlwsbTools.getLxdh=function(){return this.getCookie("LOGIN_USER").QYXXS[0].LXDH},hlwsbTools.getKhyh=function(){return this.getCookie("LOGIN_USER").QYXXS[0].KHYH},hlwsbTools.getYhzh=function(){return this.getCookie("LOGIN_USER").QYXXS[0].YHZH},hlwsbTools.getDz=function(){return this.getCookie("LOGIN_USER").QYXXS[0].JYDZ},hlwsbTools.getSwjgLrrDm=function(){return this.getCookie("LOGIN_USER").QYXXS[0].LRR_DM},hlwsbTools.getUserType=function(){return parseInt(this.getCookie("QX_USER").data.USER_TYPE)},hlwsbTools.getNSRZG_DM=function(){return this.getCookie("QX_USER").data.NSRZG_DM},hlwsbTools.getNsrsbh=function(){var e=this.getUserZh();switch(this.getUserType()){case 3:break;case 4:e=e.substr(0,e.length-3);break;default:e=""}return e},hlwsbTools.getDjxh=function(){return this.getCookie("LOGIN_USER").QYXXS[0].DJXH},hlwsbTools.getUserSwjgMc=function(){return this.getCookie("QX_USER").data.SWJG_MC},hlwsbTools.getUserSwjgDm=function(){return this.getCookie("QX_USER").data.SWJG_DM},hlwsbTools.getUserZgswjDm=function(){return this.getCookie("QX_USER").data.ZGSWJ_DM},hlwsbTools.getNSRMC=function(){return this.getCookie("QX_USER").data.NSRMC},hlwsbTools.getCurServerDate=function(){return this.getCookie("LOGIN_USER").mapParam.CUR_DATE},hlwsbTools.getFkpjBh=function(){return this.getSkpBz()==0?this.getCookie("QX_USER").data.USER_FKPJBH:hlwsbTools.getSkpTools().getSkph(0)},hlwsbTools.getSkpBz=function(){return this.getYwxtDm()=="cgs"?0:1},hlwsbTools.getYwxtDm=function(){return this.getCookie("LOGIN_USER").KPJS[0].YWXT_DM},hlwsbTools.getCurKpyPlx=function(){return this.getCookie("LOGIN_USER").KPJS[0].PLX},hlwsbTools.getDJZCLX_DM=function(){return this.getCookie("QX_USER").data.DJZCLX_DM},hlwsbTools.ERR_CODES=[{STATE:"10000",MSG:"操作成功!"},{STATE:"10001",MSG:"发票代码非法!"},{STATE:"10002",MSG:"期末库存存在此段发票!"},{STATE:"10003",MSG:"期末库存不存在此段发票 !"},{STATE:"10004",MSG:"此发票没有作废记录!"},{STATE:"10005",MSG:"该张发票已作废，不能重复作废!"},{STATE:"10006",MSG:"补开原发票不能作废!"},{STATE:"10007",MSG:"跨月发票不能作废!"},{STATE:"10008",MSG:"查询无此张发票!"},{STATE:"10009",MSG:"请首先填写企业基本信息!"},{STATE:"10010",MSG:"没有可用发票,请领购发票!"},{STATE:"10011",MSG:"该发票已生成申报表,不能重复生成!"},{STATE:"10012",MSG:"该发票已经存在,不能重复开具!"},{STATE:"10013",MSG:"更新原发票状态失败!"},{STATE:"10014",MSG:"此所属期数据已经存在!"},{STATE:"10015",MSG:"原发票是作废发票,不能对作废发票执行此操作!"},{STATE:"10016",MSG:"此车价号码的发票已经存在,不能重复开具,数据保存失败!"},{STATE:"10017",MSG:"扣款数据同步失败,数据保存失败!"},{STATE:"10018",MSG:"发票起止号不正确,请检查此段发票是否在领购的票段中!"},{STATE:"10019",MSG:"操作失败,负数发票对应的正数发票的发票代码、发票号码不存在!"},{STATE:"20000",MSG:"操作失败!"},{STATE:"90010",MSG:"会话超时,请重新登陆!"},{STATE:"90011",MSG:"无权访问此功能!"},{STATE:"90099",MSG:"未知错误，请向管理员联系!"}],hlwsbTools.getErrByCode=function(e){var t="无法识别的状态『"+e+"』",n=hlwsbTools.ERR_CODES;for(var r in n)if(n[r].STATE==e){t=n[r].MSG;break}return t+"!"},hlwsbTools.setCookieJsonObjLogin=function(e){return this.checkCookie()?(this.setCookie("QX_USER",e),!0):!1},hlwsbTools.setCookieJsonObj=function(e){return this.checkCookie()?(this.setCookie("LOGIN_USER",e),!0):!1},hlwsbTools.clearAllCookie=function(){this.delCookie("LOGIN_USER"),this.delCookie("QX_USER"),this.delCookie("USER_SEQ")},hlwsbTools.setCookie=function(e,t){/[\]\}]$/.test(t)&&(t=baseTools.stringify(t)),$.cookie(e,t,{expires:1,path:"/"})},hlwsbTools.getCookie=function(e){if(!this.checkCookie())return this.gotoLogin(),"";var t=$.cookie(e);return t==null?(alert("获取不到["+e+"]的指定值,请重新登陆!"),this.getCurPage().indexOf("manage")!=-1?this.gotoAdminLogin():this.gotoLogin(),""):baseTools.parse(t)},hlwsbTools.delCookie=function(e){$.cookie(e,null,{path:"/"})},baseTools.checkCookie=function(){var e=navigator.cookieEnabled?!0:!1;return e?!0:(alert("请开启浏览器COOKIE功能!"),!1)},baseTools.invalidat=function(){var e=document.getElementsByTagName("input");for(var t=0;t<e.length;t++)e[t].disabled=!0},baseTools.gotoLogin=function(){top.window.location.href=this.getLogin()},baseTools.gotoAdminLogin=function(){top.window.location.href=this.getAdminLogin()},baseTools.getWebRoot=function(){if(location.href.indexOf("http")!=-1)return hlwsbTools.cnf.contextPath;var e=[],t=location.href.split("/");for(var n in t){if(t[n]=="web")break;e.push(t[n])}return e.push("web"),e.join("/")},baseTools.getLogin=function(){return this.getWebRoot()+"/hlwsb/login.html"},baseTools.getAdminLogin=function(){return this.getWebRoot()+"/manage/login.html"},baseTools.getCaLogin=function(){return this.getWebRoot()+"/hlwsb/login.html"},hlwsbTools.getMmGridHeight=function(e){var t=2,n=e.next();n.size()!=0&&(t=n.height()==0?24:n.height());var r=document.documentElement.clientHeight,i=baseTools.getCurBrowser().isIE7?29-t:0;return r-Math.abs(e.offset().top)-t-i},hlwsbTools.getMmGridHeightOld=function(e){var t=2,n=e.next();n.size()!=0&&(t=n.height()==0?24:n.height());var r=document.documentElement.clientHeight,i=baseTools.getCurBrowser().isIE7?190:0;return r-e.offset().top-t-i},baseTools.xhrAjax=function(e){hlwsbTools.cnf.clientURL!=""?e.url=hlwsbTools.cnf.clientURL+e.url:e.url=hlwsbTools.cnf.contextPath+e.url;var t=e.params||{},n=!0;for(var r in t)"CUR_USERID"==r&&(n=!1);return n&&(t.CUR_USERID=hlwsbTools.getUserId(),t.NSRSBH=hlwsbTools.getUserZh(),!t.SSSQ_Q&&hlwsbTools.getSSSQ_Q()&&(t.SSSQ_Q=hlwsbTools.getSSSQ_Q()),!t.SSSQ_Z&&hlwsbTools.getSSSQ_Z()&&(t.SSSQ_Z=hlwsbTools.getSSSQ_Z()),!t.NSRLX_DM&&hlwsbTools.getNSRLX_DM()&&(t.NSRLX_DM=hlwsbTools.getNSRLX_DM())),e.params=t,this.xhrAjaxJsonP(e)},hlwsbTools.getNSRLX_DM=function(){var e=baseTools.getUrlQueryString("NSRLX_DM");return e?e:""},hlwsbTools.getSSSQ_Q=function(){var e=baseTools.getUrlQueryString("SSSQ_Q");return e?e:""},hlwsbTools.getSSSQ_Z=function(){var e=baseTools.getUrlQueryString("SSSQ_Z");return e?e:""},hlwsbTools.getCentsFramt=function(e,t,n){if(isNaN(e-0))return e;if(!t||t=="")t=2;if(typeof n=="undefined"||n.length==0)n="true";e-=0,e=String(e.toFixed(t));if(n=="fasle"){var r=/(-?\d+)(\d{3})/;while(r.test(e))e=e.replace(r,"$1,$2")}return e},hlwsbTools.urlStr=function(e){var t="";for(var n in e)t+=n+"="+e[n]+"&";return t.substr(0,t.length-1)},hlwsbTools.isYH=function(){var e=this.getCookie("QX_USER").data.HY_DM;return e=="6600"||e=="6900"?!0:!1},hlwsbTools.isHY_41_43=function(){var e=this.getCookie("QX_USER").data.HY_DM;return e=="4100"||e=="4300"?!0:!1},hlwsbTools.isCj_jldw=function(e){return e=="0110"?!0:!1},hlwsbTools.compareDate=function(e,t){if(!e||!t)return!1;var n=e.split("-"),r=t.split("-"),i=(new Date(n[0],n[1],n[2])).getTime(),s=(new Date(r[0],r[1],r[2])).getTime();return i>s?!0:!1},hlwsbTools.isXgmGrGtgsh=function(e){return e=="410"||e=="430"?!0:!1},hlwsbTools.trim=function(e){return e?e.replace(/(^\s*)|(\s*$)/g,""):e},hlwsbTools.isHKMY=function(e){return e?"101020604"==e||"0818"==e?!0:!1:!1},hlwsbTools.isHK_SN_WQQY=function(e){return e?"0814"==e||"0818"==e||"0811"==e?!0:!1:!1},hlwsbTools.isSBBZT_SB=function(e,t){return e=="2"||e=="3"?(parseInt(t)==1&&alert("已申报，不能保存"),parseInt(t)==2&&alert("已申报，不能删除"),!0):!1},hlwsbTools.checkMonth=function(e,t){if(!e||!t)return!1;var n=e.split("-")[1];for(var r=0;r<t.length;r++)if(n==t[r])return!0;return!1},hlwsbTools.getElemFromDate=function(e,t){if(e){var n=e.split("-");return n[t]}return 0},hlwsbTools.isNB=function(e,t){var n=parseInt(e.split("-")[1]),r=parseInt(t.split("-")[1]);return r-n==11?!0:!1},hlwsbTools.checkSsqDate=function(str){var reg=/^\d{4}-{1}[0-1]{1}[0-9]{1}-{1}[0-3]{1}[0-9]{1}$/;if(str.match(reg)){var y=parseInt(eval(str.split("-")[0])),m=parseInt(eval(str.split("-")[1])),d=parseInt(eval(str.split("-")[2]));return parseInt(y)<=0||parseInt(m)<=0||parseInt(d)<=0?(alert("所属期有误，请重新登录系统！"),!1):!0}return alert("所属期有误，请重新登录系统！"),!1},hlwsbTools.checkDateForm=function(str){var reg=/^\d{4}-{1}[0-1]{1}[0-9]{1}-{1}[0-3]{1}[0-9]{1}$/;if(str.match(reg)){var y=parseInt(eval(str.split("-")[0])),m=parseInt(eval(str.split("-")[1])),d=parseInt(eval(str.split("-")[2]));return parseInt(y)<=0||parseInt(m)<=0||parseInt(d)<=0?!1:!0}return!1},hlwsbTools.getMapListKey=function(e,t,n){return e&&e[t]&&e[t][n]?e[t][n]:"0.00"},hlwsbTools.getSBMS=function(){return 2},hlwsbTools.getQysdsZsxm=function(){return"04"},hlwsbTools.isDjzclx_dm4143=function(){var e=hlwsbTools.getDJZCLX_DM();return e=e.substr(0,2),"41"==e||"43"==e?!0:!1},$(function(){var e=baseTools.getUrlQueryString("HIDE");if(e&&e=="1"){var t=$(":button");if(t&&t.length>0)for(var n=0;n<t.length;n++)t[n].value.indexOf("返回")!=-1&&(t[n].parentNode.style.display="none")}var r=$(".toolBar").find("#calcButton");r.length==0&&$(".toolBar").append('<li id="calcButton" style="display:none;" class="line">line</li><li  style="display:none;" id="inputLi" class=""><input style="vertical-align: middle;" checked id="calcInput" type="checkbox" onclick="cell.calcManual(this);">是否自动计算</li>')}),hlwsbTools.getDaysInMonth=function(e,t){t=parseInt(t),e=parseInt(e);switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 4:case 6:case 9:case 11:return 30}return e%100==0||e%4!=0?28:29},hlwsbTools.isNotGsqy=function(e){return e!=0x9308563fa1a?!0:!1},hlwsbTools.isNotSydw=function(e){return e!=0x9308563fa2e?!0:!1},hlwsbTools.isZZS_XGM=function(e){return e=="101010201"},hlwsbTools.isZZS_CPY_YBNSR=function(e){return e=="101010101"||e=="101010102"},hlwsbTools.dateDiff=function(e,t,n){if(!t||!n)return 0;typeof t=="string"&&(t=new Date(t.replace(/\-/g,"/"))),typeof n=="string"&&(n=new Date(n.replace(/\-/g,"/")));var r=(n.getTime()-t.getTime())/1e3/60/60;switch(e){case"ww":r/=7;break;case"dd":r/=24;break;case"hh":r/=60;break;case"nn":r/=60}return Math.ceil(r)},document.onkeyup=function(e){e=e||window.event,e.keyCode==17&&(window._ctrl=!1)},document.onkeydown=function(e){e=e||window.event,e.keyCode==17?window._ctrl=!0:window._ctrl&&e.keyCode==119?showAutoCalc():window._ctrl=!1},hlwsbTools.helpWD=function(){var e=900,t=600,n=(window.screen.availHeight-30-t)/2,r=(window.screen.availWidth-10-e)/2,i=baseTools.getUrlQueryString("SBBZL_DM");window.open("/hlwsb/help/help.html?SBBZL_DM="+i,"","height="+t+",,innerHeight="+t+",width="+e+",innerWidth="+e+",top="+n+",left="+r+",toolbar=no,menubar=no,scrollbars=yes,resizeable=yes,location=no,status=no")},hlwsbTools.cont=function(e){if(e){var t=1,n=e.split("*");for(var r=0;r<n.length;r++)t*=parseFloat(hlwsbTools.trim(n[r]));return parseFloat(t.toFixed(2))}return 0},hlwsbTools.getYhyZsl=function(){return.005},hlwsbTools.isXgmNsr=function(e){return e=="101010201"},hlwsbTools.setSSq=function(e,t){if(e){var n=e.split("-"),r="";return t?r=n[0]+"年"+n[1]+"月"+n[2]+"日":r=n[0]+"年"+n[1]+"月",r}}
//cellTools
//jsonw
JSON={},function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()